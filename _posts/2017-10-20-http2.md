---
layout: post
title: Http 2.0
category: network
tags: http
---
## Http 1.1 缺陷
### Head of line blocking
- http 1.1 可以在没有得到前一个请求的响应的时候，就发送下一个请求，这就是pipeline。
- 但是http1.1要求请求的响应按照请求发送的顺序完整返回，也就是说服务器必须按照接收请求的顺序发送响应，如果第一个请求的响应很慢，那么之后发出的请求都会受影响，这就是Head of line blocking。
- 在HTTP1.1中，不会出现请求A早于请求B发送出去，但是请求A的响应却迟于请求B的响应到达客户端。
### 连接数量限制 
- keep-alive和pipeline提高了http的吞吐量但是对同一域名的TCP连接数量设置了上限(4-6)。
- 为了提高传输效率，很多网站使用不同域名的CDN来serve请求，使得一个网页的大量请求分散在更多的TCP连接上传输。 
### http 1.1 是基于文本的
### content-length被设置后，很难中断这个请求，虽然可以通过中断TCP连接的方式中断请求，但是，重新建立TCP的成本太高。

---
## HTTP 2.0
### 二进制协议
- 在应用层和传输层之间增加了一个二进制分帧层，负责在HTTP1.1请求的文本格式和二进制帧之间做转换。

### 多路复用
- 请求分为多个stream，多个stream可以交叉传输
- 响应分为多个块，不同响应的块在TCP连接上交叉传送
### 首部压缩
### 服务端推送
- 在收到一个请求时，服务器猜测客户端也许需要另一个资源，在收到客户端对该资源的请求之前就把该资源发送给客户端
### http2中可以发送RST_STREAM帧中断请求